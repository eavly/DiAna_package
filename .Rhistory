"frotteurism","masochism",
"paraphilia","paedophilia",
"sadism","transvestism",
"voyeurism",
"sexually inappropriate behaviour"),
"compulsive shopping"=list("compulsive shopping"),
"hyperphagia"=list("binge eating","food craving",
"hyperphagia","increased appetite"),
"kleptomania"=list("kleptomania","shoplifting"),
"schizophrenia"=list(c(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt)))
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = deduplicated
)
View(custom_group)
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = deduplicated,
order="drug"
)
View(custom_group)
list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt)
list("kleptomania","shoplifting")
list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt)
list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"][,.(pt)])
MedDRA[hlgt=="schizophrenia and other psychotic disorders"][,.(pt)]
reac_selected <- list("gambling disorder"=list("gambling disorder","gambling"),
"hypersexuality"= list("compulsive sexual behaviour",
"hypersexuality",
"excessive masturbation",
"excessive sexual fantasies",
"libido increased",
"sexual activity increased",
"kluver-bucy syndrome",
"erotophonophilia",
"exhibitionism","fetishism",
"frotteurism","masochism",
"paraphilia","paedophilia",
"sadism","transvestism",
"voyeurism",
"sexually inappropriate behaviour"),
"compulsive shopping"=list("compulsive shopping"),
"hyperphagia"=list("binge eating","food craving",
"hyperphagia","increased appetite"),
"kleptomania"=list("kleptomania","shoplifting"),
"schizophrenia"=MedDRA[hlgt=="schizophrenia and other psychotic disorders"][,.(pt)])
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = deduplicated,
order="drug"
)
View(custom_group)
as.list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt]
as.list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt])
as.list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt)
reac_selected <- list("gambling disorder"=list("gambling disorder","gambling"),
"hypersexuality"= list("compulsive sexual behaviour",
"hypersexuality",
"excessive masturbation",
"excessive sexual fantasies",
"libido increased",
"sexual activity increased",
"kluver-bucy syndrome",
"erotophonophilia",
"exhibitionism","fetishism",
"frotteurism","masochism",
"paraphilia","paedophilia",
"sadism","transvestism",
"voyeurism",
"sexually inappropriate behaviour"),
"compulsive shopping"=list("compulsive shopping"),
"hyperphagia"=list("binge eating","food craving",
"hyperphagia","increased appetite"),
"kleptomania"=list("kleptomania","shoplifting"),
"schizophrenia"=as.list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt))
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = deduplicated,
order="drug"
)
df <- rbindlist(list(
df,
custom_group[, nested := "custom"]
),fill = TRUE)
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod","steelblue"),
threshold =0, show_legend = TRUE,
row="event",levs_row = names(reac_selected), facet_v=NA)
df <- rbindlist(list(
DPA_df[, nested := "main"],
DPA_df_deduplicated[, nested := "deduplicated"]
))
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
df <- rbindlist(list(
df,
custom_group[, nested := "custom"]
),fill = TRUE)
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod","steelblue"),
threshold =0, show_legend = TRUE,
row="event",levs_row = names(reac_selected), facet_v=NA)
schizophrenia <- Indi[indi_pt %in% MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt]$primaryid
restriction <- intersect(deduplicated,schizophrenia)
DPA_df_deduplicated <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
restriction = restriction
)
df <- rbindlist(list(
DPA_df[, nested := "main"],
DPA_df_deduplicated[, nested := "deduplicated"]
))
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod"),
threshold =0, show_legend = TRUE,
row="event",levs_row = reac_selected, facet_v=NA)
# straightforward analysis --------
reac_selected <- list("gambling disorder",
"hypersexuality",
"compulsive shopping",
"hyperphagia",
"kleptomania",
"schizophrenia")
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod"),
threshold =0, show_legend = TRUE,
row="event",levs_row = reac_selected, facet_v=NA)
deduplicated <- Demo[RB_duplicates_only_susp == FALSE]$primaryid
schizophrenia <- Indi[indi_pt %in% MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt]$primaryid
restriction <- intersect(deduplicated,schizophrenia)
DPA_df_deduplicated <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
restriction = restriction
)
df <- rbindlist(list(
DPA_df[, nested := "main"],
DPA_df_deduplicated[, nested := "deduplicated"]
))
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod"),
threshold =0, show_legend = TRUE,
row="event",levs_row = reac_selected, facet_v=NA)
reac_selected <- list("gambling disorder"=list("gambling disorder","gambling"),
"hypersexuality"= list("compulsive sexual behaviour",
"hypersexuality",
"excessive masturbation",
"excessive sexual fantasies",
"libido increased",
"sexual activity increased",
"kluver-bucy syndrome",
"erotophonophilia",
"exhibitionism","fetishism",
"frotteurism","masochism",
"paraphilia","paedophilia",
"sadism","transvestism",
"voyeurism",
"sexually inappropriate behaviour"),
"compulsive shopping"=list("compulsive shopping"),
"hyperphagia"=list("binge eating","food craving",
"hyperphagia","increased appetite"),
"kleptomania"=list("kleptomania","shoplifting"),
"schizophrenia"=as.list(MedDRA[hlgt=="schizophrenia and other psychotic disorders"]$pt))
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
df <- rbindlist(list(
df,
custom_group[, nested := "custom"]
),fill = TRUE)
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod","steelblue"),
threshold =0, show_legend = TRUE,
row="event",levs_row = names(reac_selected), facet_v=NA)
# straightforward analysis --------
reac_selected <- list("gambling disorder",
"hypersexuality",
"compulsive shopping",
"hyperphagia",
"kleptomania",
"bipolar disorder")
DPA_df <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
order = "drug"
)
print(DPA_df[, .(drug, event, label_ROR)])
render_forest(DPA_df, "ROR", threshold = 1,
row="event",levs_row = reac_selected, facet_v=NA)
print(DPA_df[, .(drug, event, label_IC)])
render_forest(DPA_df, "IC", threshold = 0,
row="event",levs_row = reac_selected, facet_v=NA)
deduplicated <- Demo[RB_duplicates_only_susp == FALSE]$primaryid
bipolar_disorder <- Indi[indi_pt %in% MedDRA[hlgt=="manic and bipolar mood disorders and disturbances"]$pt]$primaryid
restriction <- intersect(deduplicated,bipolar_disorder)
DPA_df_deduplicated <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
restriction = restriction
)
df <- rbindlist(list(
DPA_df[, nested := "main"],
DPA_df_deduplicated[, nested := "deduplicated"]
))
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod"),
threshold =0, show_legend = TRUE,
row="event",levs_row = reac_selected, facet_v=NA)
reac_selected <- list("gambling disorder"=list("gambling disorder","gambling"),
"hypersexuality"= list("compulsive sexual behaviour",
"hypersexuality",
"excessive masturbation",
"excessive sexual fantasies",
"libido increased",
"sexual activity increased",
"kluver-bucy syndrome",
"erotophonophilia",
"exhibitionism","fetishism",
"frotteurism","masochism",
"paraphilia","paedophilia",
"sadism","transvestism",
"voyeurism",
"sexually inappropriate behaviour"),
"compulsive shopping"=list("compulsive shopping"),
"hyperphagia"=list("binge eating","food craving",
"hyperphagia","increased appetite"),
"kleptomania"=list("kleptomania","shoplifting"),
"bipolar disorder"=as.list(MedDRA[hlgt=="manic and bipolar mood disorders and disturbances"]$pt))
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
df <- rbindlist(list(
df,
custom_group[, nested := "custom"]
),fill = TRUE)
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod","steelblue"),
threshold =0, show_legend = TRUE,
row="event",levs_row = names(reac_selected), facet_v=NA)
reac_selected <- list("gambling disorder"=list("gambling disorder","gambling"),
"hypersexuality"= list("compulsive sexual behaviour",
"hypersexuality",
"excessive masturbation",
"excessive sexual fantasies",
"libido increased",
"sexual activity increased",
"kluver-bucy syndrome",
"erotophonophilia",
"exhibitionism","fetishism",
"frotteurism","masochism",
"paraphilia","paedophilia",
"sadism","transvestism",
"voyeurism",
"sexually inappropriate behaviour"),
"compulsive shopping"=list("compulsive shopping"),
"hyperphagia"=list("binge eating","food craving",
"hyperphagia","increased appetite"),
"kleptomania"=list("kleptomania","shoplifting"),
"bipolar disorder"=as.list(MedDRA[hlt=="bipolar disorders"]$pt))
custom_group <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
df <- rbindlist(list(
DPA_df[, nested := "main"],
DPA_df_deduplicated[, nested := "deduplicated"]
))
df <- rbindlist(list(
df,
custom_group[, nested := "custom"]
),fill = TRUE)
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod","steelblue"),
threshold =0, show_legend = TRUE,
row="event",levs_row = names(reac_selected), facet_v=NA)
warning_date <- 20160305
pre_warning <- Demo[init_fda_dt < warning_date]$primaryid
restriction <- intersect(restriction,pre_warning)
# pre-warning ------------
warning_date <- 20160305
pre_warning <- Demo[init_fda_dt < warning_date]$primaryid
restriction <- intersect(restriction,pre_warning)
preW <- disproportionality_analisis(
drug_selected = "aripiprazole",
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
df <- rbindlist(list(
df,
preW[, nested := "pre_warning"]
),fill = TRUE)
render_forest(df, "IC", nested = TRUE,
nested_colors=c("salmon","goldenrod","steelblue","limegreen"),
threshold =0, show_legend = TRUE,
row="event",levs_row = names(reac_selected), facet_v=NA)
# heatmap -----------
preW <- disproportionality_analisis(
drug_selected = list("aripiprazole","brexpiprazole","cariprazine","pramipexole","ropinirole","rotigotine"),
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
##list of pts does not work anymore
heatmap_ROR <- function(ROR_df,drugs=drug_selected,text=NA,angle_text=0){
## function to visualize RORs
## Args
my_colors <- c("white","#fdfd96","#ff6961")
names(my_colors) <- c("no signal","light signal","strong signal")
drugs <- as.character(drugs)
ggplot(ROR_df,aes(x=drug,y=event))+
geom_tile(aes(fill=color),colour="black")+
geom_text(aes(label= ifelse(is.na(text),NA,label)),angle=angle_text)+
theme_classic()+
facet_grid(rows = vars(soc), scales = "free", space = "free") +
scale_fill_manual(name="color", values=my_colors)+
scale_x_discrete(position="top")+
theme(axis.text.x = element_text(size=10,angle = 90), axis.text.y = element_text(size=10,angle = 0),axis.title = element_blank(),
strip.text.y = element_text(angle=0))
}
View(df)
my_colors <- c("white","#fdfd96","#ff6961")
names(my_colors) <- c("no signal","light signal","strong signal")
# heatmap -----------
drug_selected <- list("aripiprazole","brexpiprazole","cariprazine","pramipexole","ropinirole","rotigotine")
drugs=drug_selected
text=NA
angle_text=0
drugs <- as.character(drugs)
df_multidrug <- disproportionality_analisis(
drug_selected = ,drug_selected,
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
View(df_multidrug)
restriction <- intersect(deduplicated,bipolar_disorder)
df_multidrug <- disproportionality_analisis(
drug_selected = ,drug_selected,
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = restriction,
order="drug"
)
View(df_multidrug)
df_multidrug <- disproportionality_analisis(
drug_selected = ,drug_selected,
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = deduplicated,
order="drug"
)
df <- df_multidrug
View(df_multidrug)
ggplot(df,aes(x=drug,y=event))+
geom_tile(aes(fill=color),colour="black")+
geom_text(aes(label= ifelse(is.na(text),NA,label)),angle=angle_text)+
theme_classic()+
facet_grid(rows = vars(soc), scales = "free", space = "free") +
scale_fill_manual(name="color", values=my_colors)+
scale_x_discrete(position="top")+
theme(axis.text.x = element_text(size=10,angle = 90), axis.text.y = element_text(size=10,angle = 0),axis.title = element_blank(),
strip.text.y = element_text(angle=0))
ggplot(df,aes(x=drug,y=event))+
geom_tile(aes(fill=color),colour="black")+
geom_text(aes(label= ifelse(is.na(text),NA,label)),angle=angle_text)+
theme_classic()+
#facet_grid(rows = vars(soc), scales = "free", space = "free") +
scale_fill_manual(name="color", values=my_colors)+
scale_x_discrete(position="top")+
theme(axis.text.x = element_text(size=10,angle = 90), axis.text.y = element_text(size=10,angle = 0),axis.title = element_blank(),
strip.text.y = element_text(angle=0))
color="color_IC"
df <- df[, color := color_IC]
ggplot(df,aes(x=drug,y=event))+
geom_tile(aes(fill=color),colour="black")+
geom_text(aes(label= ifelse(is.na(text),NA,label)),angle=angle_text)+
theme_classic()+
#facet_grid(rows = vars(soc), scales = "free", space = "free") +
scale_fill_manual(name="color", values=my_colors)+
scale_x_discrete(position="top")+
theme(axis.text.x = element_text(size=10,angle = 90), axis.text.y = element_text(size=10,angle = 0),axis.title = element_blank(),
strip.text.y = element_text(angle=0))
ggplot(df_multidrug)+
geom_point(aes(x=drug,y=event,size=log10(cases),color=IC_lower))
ggplot(df_multidrug)+
geom_point(aes(x=drug,y=event,size=log10(cases),color=IC_lower))+
scale_color_gradient2(low = "gray",mid="white",high = "red",midpoint = 0)
ggplot(df_multidrug)+
geom_point(aes(x=drug,y=event,size=log10(cases),color=IC_lower))+
scale_color_gradient2(low = "gray",mid="white",high = "red",midpoint = 0)+
theme_bw()
# heatmap -----------
drug_selected <- list("aripiprazole","brexpiprazole","pramipexole","paracetamol","etanercept","nivolumab")
df_multidrug <- disproportionality_analisis(
drug_selected = ,drug_selected,
reac_selected = reac_selected,
event_names = names(reac_selected),
restriction = deduplicated,
order="drug"
)
ggplot(df_multidrug)+
geom_point(aes(x=drug,y=event,size=log10(cases),color=IC_lower))+
scale_color_gradient2(low = "gray",mid="white",high = "red",midpoint = 0)+
theme_bw()
citation("DiAna")
library(devtools)
styler::style_dir()
usethis::use_tidy_description()
build_readme()
styler::style_dir()
usethis::use_tidy_description()
build_readme()
styler::style_dir()
usethis::use_tidy_description()
build_readme()
styler::style_dir()
usethis::use_tidy_description()
build_readme()
library(devtools)
styler::style_dir()
usethis::use_tidy_description()
build_readme()
build_readme()
document()
load_all()
test()
install()
# remove.packages("DiAna")
library(DiAna)
citation(DiAna)
citation("DiAna")
library(devtools)
styler::style_dir()
#usethis::use_tidy_description()
build_readme()
document()
load_all()
test()
check()
install()
# remove.packages("DiAna")
library(DiAna)
# straightforward analysis --------
reac_selected <- list(
"gambling disorder",
"hypersexuality",
"compulsive shopping",
"hyperphagia",
"kleptomania",
"bipolar disorder"
)
Drug <- import("DRUG", "23Q1")
remove.packages("DiAna")
library(devtools)
styler::style_dir()
build_readme()
document()
load_all()
test()
install()
# remove.packages("DiAna")
library(DiAna)
Drug <- import("DRUG", "23Q1")
DiAna_url <- "https://osf.io/download/epkqf/"
quarter == "23Q1"
# Download and extract DiAna data
zip_path <- paste0(here(), "/data/", quarter, ".zip")
quarter = "23Q1"
library(devtools)
styler::style_dir()
build_readme()
document()
load_all()
test()
install()
library(devtools)
styler::style_dir()
build_readme()
document()
load_all()
test()
remove.packages("DiAna")
install()
